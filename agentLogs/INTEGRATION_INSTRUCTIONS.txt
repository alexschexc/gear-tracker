"""
INTEGRATION INSTRUCTIONS FOR CSV IMPORT/EXPORT MODULE

This file contains step-by-step instructions for integrating the new
CSV import/export UI components into ui.py.

PREREQUISITE: csv_import_export.py must be in the same directory as ui.py.

=====================================================================
STEP 1: Add imports to ui.py (at the top with other imports)
=====================================================================

Add these two imports near the top of ui.py:

```python
from PyQt6.QtWidgets import QFileDialog
```

And after the gear_tracker imports, add:

```python
from csv_import_export import (
    create_import_export_tab,
    DuplicateResolutionDialog,
    ImportProgressDialog,
)
```

=====================================================================
STEP 2: Add create_import_export_tab method to GearTrackerApp class
=====================================================================

Add this method to the GearTrackerApp class (you can add it after
create_transfers_tab method, around line 2756):

```python
def create_import_export_tab(self):
    """Create Import/Export tab using CSV import/export module."""
    from csv_import_export import create_import_export_tab
    
    widget = create_import_export_tab(
        repo=self.repo,
        message_box_class=QMessageBox,
        qfiledialog_class=QFileDialog
    )
    return widget
```

=====================================================================
STEP 3: Add Import/Export tab to UI
=====================================================================

In the init_ui() method (around line 82), add this line after
the transfers tab:

```python
self.tabs.addTab(self.create_import_export_tab(), "üìÅ Import/Export")
```

The complete section should look like:

```python
self.tabs.addTab(self.create_firearms_tab(), "üî´ Firearms")
self.tabs.addTab(self.create_attachments_tab(), "üîß Attachments")
self.tabs.addTab(self.create_reloading_tab(), "üß™ Reloading")
self.tabs.addTab(self.create_soft_gear_tab(), "üéí Soft Gear")
self.tabs.addTab(self.create_consumables_tab(), "üì¶ Consumables")
self.tabs.addTab(self.create_loadouts_tab(), "üéí Loadouts")
self.tabs.addTab(self.create_checkouts_tab(), "üìã Checkouts")
self.tabs.addTab(self.create_borrowers_tab(), "üë• Borrowers")
self.tabs.addTab(self.create_nfa_items_tab(), "üîá NFA Items")
self.tabs.addTab(self.create_transfers_tab(), "üìã Transfers")
self.tabs.addTab(self.create_import_export_tab(), "üìÅ Import/Export")
```

=====================================================================
STEP 4: Refresh UI after import (optional)
=====================================================================

The import module returns ImportResult objects. If you want to refresh
the UI after a successful import, you can modify the import_csv_data
function in csv_import_export.py to call refresh_all() after import:

Find line with:
```python
# Note: UI refresh should be handled by caller
return result
```

Replace with:
```python
# Refresh UI if any rows were imported
if result and (result.imported > 0 or result.overwritten > 0):
    # You would need to pass a refresh_callback or store a reference
    pass  # Manual refresh required after closing dialog
return result
```

=====================================================================
STEP 5: Test the integration
=====================================================================

After making the changes:

1. Launch the application: python ui.py
2. Navigate to the "üìÅ Import/Export" tab
3. Test "Export All Data to CSV"
4. Test "Generate Complete Template"
5. Test "Preview CSV (Dry Run)" with a CSV file
6. Test import with a small CSV file

=====================================================================
TROUBLESHOOTING
=====================================================================

Q: "NameError: name 'create_import_export_tab' is not defined"
A: Make sure you added the import in Step 1

Q: "AttributeError: 'GearTrackerApp' object has no attribute 'QMessageBox'"
A: Make sure you imported QMessageBox at the top of ui.py

Q: "ModuleNotFoundError: No module named 'csv_import_export'"
A: Make sure csv_import_export.py is in the same directory as ui.py

Q: Dialog doesn't show import results
A: The module uses QMessageBox.information() to show results.
   If you want results in the UI, modify the _show_import_results
   function in csv_import_export.py to update a UI widget instead.

=====================================================================
FILE SUMMARY
=====================================================================

Files involved:
- csv_import_export.py (NEW) - Contains all UI components
- ui.py (MODIFY) - Add imports and integration code

Total changes to ui.py:
- 1 import statement (QFileDialog) - likely already there
- 1 import statement (from csv_import_export) - add
- 1 method (create_import_export_tab) - add ~6 lines
- 1 line (addTab) - add 1 line

Total: ~8 lines of code to add to ui.py
